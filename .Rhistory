comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
sort(colSums(comp.subset), decreasing = TRUE)
unique(comp.attr$water)
sort(colSums(comp.subset), decreasing = TRUE)
sort(colSums(comp.subset), decreasing = TRUE)
sort(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), decreasing = TRUE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
sort(colSums(comp.subset), decreasing = TRUE)
print("Plot Occupancy in Dataset:")
sort(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), decreasing = TRUE)
sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips&
comp.attr$fertilization %in% selected.fert,] %>% filter(year != 2008)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips&
comp.attr$fertilization %in% selected.fert,] %>% filter(comp.attr$year != 2008)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips&
comp.attr$fertilization %in% selected.fert,] %>% filter(comp.attr$year != 2008)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2009:2018)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
expect_true(nrow(ord.att) == nrow(ord.mat))
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
#WAPS.pca <- prcomp(ord.mat)
#PCA_xy <- cbind(data.frame(ord.att), data.frame(X = WAPS.pca$x[,1], Y = WAPS.pca$x[,2]))
WAPS.mds$stress
library(ggplot2)
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw()
distmat <- vegdist(decostand(ord.mat, "total"), method = "euclidean")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
WAPS.mds$stress
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw()
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf), aes(color = NULL), "stress")
?geom_text
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf), aes(color = NULL), label = "stress")
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.5), aes(color = NULL), label = "stress")
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) + geom_point() + theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL), label = "stress")
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress", round(WAPS.mds$stress, 2)))
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress = ", round(WAPS.mds$stress, 2)))
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress =", round(WAPS.mds$stress, 2)))
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2010:2018)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
expect_true(nrow(ord.att) == nrow(ord.mat))
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress =", round(WAPS.mds$stress, 2)))
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2009:2018)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
expect_true(nrow(ord.att) == nrow(ord.mat))
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress =", round(WAPS.mds$stress, 2)))
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
expect_true(nrow(ord.att) == nrow(ord.mat))
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress =", round(WAPS.mds$stress, 2)))
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# Filtering species
waps.specs
# Filtering species
waps.specs$specname[waps.specs$group %in% c("annual", "native", "waps")]
# Filtering species
waps.specs$specname[waps.specs$group %in% c("annual", "native", "WAPS")]
waps.specs$group
View(waps.specs)
# Filtering species
waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
# Filtering species
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
com.mat %>% select(toselect)
ord.mat %>% select(toselect)
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
# A number of rows have no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = .5, Y = -.55), aes(color = NULL),
label = paste("Stress =", round(WAPS.mds$stress, 2)))
ord.mat
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -.5, yjust = .5,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -.5, vjust = .5,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = .5, vjust = .5,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = .5, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = .5,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = 0,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 2, vjust = 0,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 0, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 0, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 0, vjust = 2,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 2, vjust = 2,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -1, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -2,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -1, vjust = 1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = -1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -2,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 2, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y, color = as.factor(year))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
?cascadeKM
?pam
pam(distmat, 3)
k.cluster = pam(distmat, 3)
k.cluster = pam(distmat, 3)
k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
library(indicspecies)
IS = multipatt(decostand(ord.mat, method = "total"), k.cluster$clustering, duleg = TRUE, control = how(nperm=999))
summary(IS, alpha = .05)
k.cluster = pam(distmat, 4)
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
library(indicspecies)
IS = multipatt(decostand(ord.mat, method = "total"), k.cluster$clustering, duleg = TRUE, control = how(nperm=999))
summary(IS, alpha = .05)
plot(k.cluster)
summary(IS, alpha = .05)
cluscounts = bind_cols(comp.attr, k.cluster$clustering) %>% group_by(year, cluster) %>% summarise(count = n())
cluscounts = bind_cols(comp.attr, cluster = k.cluster$clustering) %>% group_by(year, cluster) %>% summarise(count = n())
k.cluster$clustering
bind_cols(comp.attr, cluster = k.cluster$clustering)
k.cluster$clustering
cluscounts = bind_cols(comp.attr, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
k.cluster$clustering
k.cluster
cluscounts = bind_cols(ord.attr, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
cluscounts = bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
summary(IS, alpha = .05)
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
summary(IS, alpha = .05)
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
k.cluster = pam(distmat, 3)
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
plot(k.cluster)
library(indicspecies)
IS = multipatt(decostand(ord.mat, method = "total"), k.cluster$clustering, duleg = TRUE, control = how(nperm=999))
summary(IS, alpha = .05)
cluscounts = bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
k.cluster = pam(distmat, 4)
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
plot(k.cluster)
library(indicspecies)
IS = multipatt(decostand(ord.mat, method = "total"), k.cluster$clustering, duleg = TRUE, control = how(nperm=999))
summary(IS, alpha = .05)
cluscounts = bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
