y = MDS2,
color = NULL,
label = rowname),
nudge_x = 0.05,
nudge_y = 0.03,
show.legend = FALSE) +
guides(color=guide_legend(title="Cluster ID"),
shape = guide_legend(title="Cluster ID")) +
xlab("NMDS1") +
ylab("NMDS2")
clustdat <- bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>%
dplyr::arrange(sp.trt, plot)
# Assigning states
clustdat$cluster[clustdat$cluster == 1] = "Cluster 1"
clustdat$cluster[clustdat$cluster == 2] = "Cluster 2"
clustdat$cluster[clustdat$cluster == 3] = "Cluster 3"
clustdat$cluster[clustdat$cluster == 4] = "Cluster 4"
clustdat %>% group_by(plot) %>% summarise(count = n()) %>% arrange(count)
clustdat
clustdat[clustdat$plot == 205,]
# Renaming Treatments
searchvals = c(unique(clustdat$sp.trt))
toreplace = c("1) Exotic", "2) Exotic + Native", "7) Native", "3) Exotic + Invasive + Native", "5) Invasives", "4) Exotic + Invasive", "6) Invasive + Native")
for(i in 1:length(searchvals)){
clustdat$sp.trt[clustdat$sp.trt == searchvals[i]] = toreplace[i]
}
# Plotting change in assignment over time
clustdat$plot <- factor(clustdat$plot, levels = unique(clustdat$plot))
clustdat = clustdat %>% arrange(sp.trt, plot)
fixplots <- function(x){
newvec <- c()
for(i in 1:length(x)){
if(i == 1){
newvec[i] = 1
}
else{
if(x[i] == x[i - 1]){
newvec[i] = newvec[i - 1]
}else{
newvec[i] = newvec[i - 1] + 1
}
}
}
return(newvec)
}
clustdat$plot <- fixplots(clustdat$plot)
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw()
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster))
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster))
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_tile(color = "black", aes(fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_tile(color = "black", aes(fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
cols = gg_color_hue(4)
gg_color_hue <- function(n) {
hues = seq(15, 375, length = n + 1)
hcl(h = hues, l = 65, c = 100)[1:n]
}
cols = gg_color_hue(4)
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_tile(color = "black", aes(fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot))) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) + .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 2) +
geom_vline(xintercept = 2007.5, color = "black", size = 2) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster)) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 1) +
geom_vline(xintercept = 2007.5, color = "black", size = 1) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster), size =2) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(2001, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 1) +
geom_vline(xintercept = 2007.5, color = "black", size = 1) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster), size =2) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(2004, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(1990, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 1) +
geom_vline(xintercept = 2007.5, color = "black", size = 1) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster), size =2) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(1995, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(1990, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 1) +
geom_vline(xintercept = 2007.5, color = "black", size = 1) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
clustdat %>% ggplot(aes(x = year,
y = as.numeric(plot) - .5)) +
theme_bw() +
geom_point(aes(shape = cluster, fill = cluster), size =2) +
# geom_hline(yintercept = c(seq(0, 56, by = 8)), size = 2) +
geom_text(label = unique(clustdat$sp.trt),
data = data.frame(year = rep(1999, 7),
plot = seq(4, 52, by = 8)),
fontface = "bold") +
scale_fill_manual(name = 'State Assignment',
values =c("Cluster 1" = cols[1],
"Cluster 2" = cols[2],
"Cluster 3" = cols[3],
"Cluster 4" = cols[4]),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
scale_shape_manual(name = 'State Assignment',
values =c("Cluster 1" = 21,
"Cluster 2" = 22,
"Cluster 3" = 23,
"Cluster 4" = 24),
labels = c('E. glaucus - S. pulchra',
'F. perennis - B. hordeaceous',
'E. caput-medusae - A. triuncialis',
'A. fatua - B. diandrus')) +
xlim(1990, 2019) +
geom_vline(xintercept = 2008.5, color = "black", size = 1) +
geom_vline(xintercept = 2007.5, color = "black", size = 1) +
ylab(NULL) +
xlab("Year") +
ylim(0, 57) +
theme(axis.text.y = element_blank())
