group_percents = cover[,12:23]
cover = cover[,-(12:23)]
comp.attr <- cover[,1:11]
comp.cover <- cover[,12:ncol(cover)]
# Treatment labels and group structure
trtlabels <- read.csv("../data/trtlabels.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Species treatments
waps.specs <- read.csv("../data/WAPSspecies.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Climate data
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
cat("subsetcov =", sum(ord.mat) / totalcov)
# A number of rows have  no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(year))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
counter = 1
groupdiss <- c()
groupsil <- c()
for(i in 2:10){
tempclust = pam(distmat, i)
groupdiss[counter] = mean(tempclust$clusinfo[,3])
groupsil[counter] = tempclust$silinfo$avg.width
counter <- counter + 1
}
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupsil,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupdiss,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
NbClust(decostand(ord.mat, method = "total"), min.nc = 2, max.nc = 10, method = "kmeans",
index = c("hartigan", "ch", "beale", "kl", "cindex", "db", "silhouette", "duda"))[1:2]
k.cluster = pam(distmat, 4)
k.cluster$objective
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
cluscounts = bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n())
ggplot(cluscounts, aes(x = factor(year), y = count, fill = factor(cluster))) + geom_bar(stat = "identity")
# Estimated values of Q
qmat = as.matrix(qmatrix.msm(msm.env_priority)$estimates)
colnames(qmat) = c("Natives", "WetA", "WAPS", "DryA")
rownames(qmat) = c("Natives", "WetA", "WAPS", "DryA")
# With both
plot.prevalence.msm(msm.env_priority, mintime=2008, maxtime=2018)
plot.prevalence.msm(msm.null, mintime=2008, maxtime=2018)
library(lubridate); library(tidyverse); library(tidyquant)
library(msm)
clustdat <- read.csv("../data/WAPSclusters.csv",
header = TRUE,
stringsAsFactors = FALSE)
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
climate_daily <- read.csv("../data/cimis_daily.csv",
header = TRUE,
stringsAsFactors = FALSE)
climate$month = gsub("-.*", "", climate$Month.Year)
climsum = climate_daily %>% mutate(month = month(Date), year = year(Date)) %>%
group_by(Water.Year) %>%
filter(month %in% c(11,12,1,2)) %>%
summarise(precip = sum(na.omit(Precip..mm.)),
eto = sum(ETo..mm.),
net = precip - eto) %>%
mutate(threeyear_ma = SMA(net, 3),
net_cum_2 = c(NA, rollsum(net, 2)),
net_cum_3 = c(NA, NA, rollsum(net, 3)))
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
cat("Fraction of total cover contained in subset =", sum(ord.mat) / totalcov)
# A number of rows have  no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
library(tidyverse); library(testthat); library(vegan); library(msm); library(NbClust)
library(ggplot2); library(cluster); library(mclust); library(indicspecies)
# Cover data (wide format)
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,12:23]
cover = cover[,-(12:23)]
comp.attr <- cover[,1:11]
comp.cover <- cover[,12:ncol(cover)]
# Treatment labels and group structure
trtlabels <- read.csv("../data/trtlabels.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Species treatments
waps.specs <- read.csv("../data/WAPSspecies.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Climate data
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
ord.mat
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
ord.mat
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,12:23]
cover = cover[,-(12:23)]
comp.attr <- cover[,1:11]
comp.cover <- cover[,12:ncol(cover)]
comp.cover
comp.attr
# Cover data (wide format)
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
cover
group_percents = cover[,8:19]
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,8:19]
cover = cover[,-(8:19)]
comp.attr <- cover[,1:11]
comp.cover <- cover[,12:ncol(cover)]
comp.attr
comp.cover
# Cover data (wide format)
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,8:19]
cover = cover[,-(8:19)]
comp.attr <- cover[,1:14]
comp.cover <- cover[,14:ncol(cover)]
comp.attr
comp.cover
comp.cover <- cover[,14:ncol(cover)]
comp.cover
aic(k.cluster)
bic(k.cluster)
library(tidyverse); library(testthat); library(vegan); library(msm); library(NbClust)
library(ggplot2); library(cluster); library(mclust); library(indicspecies)
# Cover data (wide format)
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,8:19]
cover = cover[,-(8:19)]
comp.attr <- cover[,1:15]
comp.cover <- cover[,15:ncol(cover)]
# Treatment labels and group structure
trtlabels <- read.csv("../data/trtlabels.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Species treatments
waps.specs <- read.csv("../data/WAPSspecies.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Climate data
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
cat("Fraction of total cover contained in subset =", sum(ord.mat) / totalcov)
# A number of rows have  no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(year))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
counter = 1
groupdiss <- c()
groupsil <- c()
for(i in 2:10){
tempclust = pam(distmat, i)
groupdiss[counter] = mean(tempclust$clusinfo[,3])
groupsil[counter] = tempclust$silinfo$avg.width
counter <- counter + 1
}
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupsil,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupdiss,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
NbClust(decostand(ord.mat, method = "total"), min.nc = 2, max.nc = 10, method = "kmeans",
index = c("hartigan", "ch", "beale", "kl", "cindex", "db", "silhouette", "duda"))[1:2]
k.cluster = pam(distmat, 4)
k.cluster$objective
MDS_xy$clust = k.cluster$clustering
bic(k.cluster)
AIC(k.cluster)
next_state = clustdat %>% mutate(year = year + 1) %>% rename(paststate = cluster)
library(tidyverse); library(testthat); library(vegan); library(msm); library(NbClust)
library(ggplot2); library(cluster); library(mclust); library(indicspecies); library(gganimate)
# Cover data (wide format)
cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,8:19]
cover = cover[,-(8:19)]
comp.attr <- cover[,1:15]
comp.cover <- cover[,15:ncol(cover)]
# Treatment labels and group structure
trtlabels <- read.csv("../data/trtlabels.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Species treatments
waps.specs <- read.csv("../data/WAPSspecies.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Climate data
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset),2), decreasing = TRUE)
specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
cat("Fraction of total cover contained in subset =", sum(ord.mat) / totalcov)
# A number of rows have  no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 5, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(year))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
p = ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(sp.trt))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
p
p = ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(sp.trt))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: {frame_time}') +
transition_time(year) +
ease_aes('linear')
p
p = ggplot(MDS_xy %>% rename(sp.trt = "Planting_Trt"), aes(X1, Y)) +
geom_point(aes(color = as.factor(Planting_Trt)), size = 2) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: {frame_time}') +
transition_time(year) +
ease_aes('linear')
p = ggplot(MDS_xy %>% rename(sp.trt), aes(X1, Y)) +
geom_point(aes(color = as.factor(sp.trt)), size = 2) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: {frame_time}') +
transition_time(year) +
ease_aes('linear')
p = ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(sp.trt)), size = 2) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: {frame_time}') +
transition_time(year) +
ease_aes('linear')
p
animate(p, detail = 20)
animate(p, detail = 40)
animate(p, detail = 40, fps = 20)
animate(p, detail = 40, fps = 10)
