cover <- read.csv("../data/comdata_wideformat.csv",
header = TRUE,
stringsAsFactors = FALSE)
group_percents = cover[,8:19]
cover = cover[,-(8:19)]
comp.attr <- cover[,1:15]
comp.cover <- cover[,15:ncol(cover)]
# Treatment labels and group structure
trtlabels <- read.csv("../data/trtlabels.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Species treatments
waps.specs <- read.csv("../data/WAPSspecies.csv",
header = TRUE,
stringsAsFactors = FALSE)
# Climate data
climate <- read.csv("../data/cimis_monthly.csv",
header = TRUE,
stringsAsFactors = FALSE)
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control", "wet", "latewet", "dry")
comp.subset = comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert,]
print("Total Cover in Dataset:")
specsbycover = sort(round(colSums(comp.subset) / sum(comp.subset),2), decreasing = TRUE)
# specsbycover
print("Plot Occupancy in Dataset:")
specsbyfreq = sort(round(colSums(decostand(comp.subset, method = "pa")) / nrow(comp.subset), 2), decreasing = TRUE)
# specsbyfreq
# What treatments and years should be selected?
selected.trts <-c("annuals", "WAPS", "Natives", "natives+WAPS+annuals", "annuals+natives", "WAPS+annuals", "WAPS+natives")
selected.clips <- c("none")
selected.fert <- c("none")
selected.water <- c("control")
selected.years <- c(2008:2018)
# To include all treatments:
# selected.water <- c("control", "wet", "latewet", "dry")
# Subsetting cover matrix
ord.mat <- comp.cover[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Subsetting attribute matrix
ord.att <- comp.attr[comp.attr$water %in% selected.water &
comp.attr$sp.trt %in% selected.trts &
comp.attr$clip %in% selected.clips &
comp.attr$fertilization %in% selected.fert &
comp.attr$year %in% selected.years,]
# Checking that these datasets are the same size
expect_true(nrow(ord.att) == nrow(ord.mat))
# Filtering species
totalcov = sum(ord.mat)
toselect = waps.specs$specname[waps.specs$group %in% c("annual", "natives", "waps")]
ord.mat = ord.mat %>% select(toselect)
cat("Fraction of total cover contained in subset =", sum(ord.mat) / totalcov)
# A number of rows have  no recorded live plants (mostly dry treatments?)
ord.att <- ord.att[rowSums(ord.mat) != 0, ]
ord.mat <- ord.mat[rowSums(ord.mat) != 0, ]
sumtable = left_join(ord.att, bind_cols(comp.attr,group_percents)) %>%
group_by(plot, year, sp.trt) %>%
select(annuals, natives, waps) %>%
mutate(total = sum(annuals, natives, waps)) %>%
group_by(year, sp.trt) %>%
summarise(annprop = mean(annuals / total),
natprop = mean(natives / total),
wapsprop = mean(waps / total),
annsem = sd(annuals / total) / sqrt(n()),
natsem = sd(natives / total) / sqrt(n()),
wapssem = sd(waps / total) / sqrt(n()))
sumtable %>%
ggplot(aes(x = year)) +
geom_line(aes(y = annprop), color = "red") +
geom_line(aes(y = natprop), color = "green") +
geom_line(aes(y = wapsprop), color = "blue") +
geom_errorbar(aes(ymin = annprop - annsem,
ymax = annprop + annsem),
color = "red",
width = .1) +
geom_errorbar(aes(ymin = natprop - natsem,
ymax = natprop + natsem),
color = "green",
width = .1) +
geom_errorbar(aes(ymin = wapsprop - wapssem,
ymax = wapsprop + wapssem),
color = "blue",
width = .1) +
xlab("Year") +
ylab("Proportional Abundance")+
facet_wrap(~sp.trt, nrow = 4)
ggsave("../figures/ProportionalAbundances.pdf", width = 10, height = 6)
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 999, trace = F, autotransform = TRUE)
# Constructing distance matrix and running NMDS
distmat <- vegdist(decostand(ord.mat, "total"), method = "bray")
WAPS.mds <- metaMDS(distmat, try = 1, trymax = 9, trace = F, autotransform = TRUE)
MDS_xy <- bind_cols(data.frame(ord.att), data.frame(X = WAPS.mds$points[,1], Y = WAPS.mds$points[,2]))
# Plotting figure
ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(color = as.factor(year))) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2)))
ggplot(MDS_xy %>% filter(year == 2008), aes(X1, Y)) +
geom_point(aes(fill = as.factor(sp.trt)), color = "black", pch = 21, size = 4) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: 2008') +
theme_void() +
scale_fill_discrete(name = "Planting Combination",
breaks = unique(MDS_xy$sp.trt),
labels = c("N", "N+A+I", "A", "N+I", "N+A", "A+I", "I")) +
theme(plot.title = element_text(size = 24, face = "bold"),
legend.title = element_text(size = 20, face = "bold"),
legend.text = element_text(size = 20, face = "bold"))
ggsave("../figures/nmds_viz_v2.png",
height = 7.5,
width = 11,
dpi = 300,
units = "in")
p = ggplot(MDS_xy, aes(X1, Y)) +
geom_point(aes(fill = as.factor(sp.trt)), color = "black", pch = 21, size = 4) +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
labs(title = 'Year: {frame_time}', size = 4) +
transition_time(year) +
ease_aes('cubic-in-out') +
theme_void() +
scale_fill_discrete(name = "Planting Combination",
breaks = unique(MDS_xy$sp.trt),
labels = c("N", "N+A+I", "A", "N+I", "N+A", "A+I", "I")) +
theme(plot.title = element_text(size = 24, face = "bold"),
legend.title = element_text(size = 20, face = "bold"),
legend.text = element_text(size = 20, face = "bold"))
animate(p, fps = 10, width= 750, height=500, duration = 15)
counter = 1
groupdiss <- c()
groupsil <- c()
for(i in 2:10){
tempclust = pam(distmat, i)
groupdiss[counter] = mean(tempclust$clusinfo[,3])
groupsil[counter] = tempclust$silinfo$avg.width
counter <- counter + 1
}
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupsil,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupdiss,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupsil,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupdiss,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
data.frame(k = c(2:10), dis = groupdiss, sil = groupsil) %>%
ggplot(aes(x = k,
y = groupsil,
fill = groupsil == max(groupsil))) +
geom_point(size = 3, pch = 21)
k.cluster = pam(distmat, 4)
k.cluster$objective
MDS_xy$clust = k.cluster$clustering
ggplot(MDS_xy, aes(X1, Y, color = as.factor(clust))) +
geom_point() +
theme_bw() +
geom_text(data = data.frame(X1 = Inf, Y = -Inf),
aes(color = NULL), hjust = 1, vjust = -1,
label = paste("Stress =", round(WAPS.mds$stress, 2))) +
ggtitle("NMDS colored by cluster")
cluscounts = bind_cols(ord.att, data.frame(cluster = k.cluster$clustering)) %>% group_by(year, cluster) %>% summarise(count = n()) %>% bind_rows(data.frame(year = 2008, cluster = 4, count = 0))
adonis(ord.mat ~ k.cluster$clustering)
adonis(ord.mat ~ as.factor(k.cluster$clustering))
piecharts = bind_cols(data.frame(cluster = k.cluster$clustering), ord.mat) %>%
mutate(g1_cov = nassella + bro.carinatus + elymus + lupinus + vulpia,
g2_cov = bro.hordeaceous + lolium + trifolium,
g3_cov = aegilops + taeniatherum,
g4_cov = avena + bro.diandrus) %>%
select(cluster, g1_cov, g2_cov, g3_cov, g4_cov)
piecharts=piecharts %>%
arrange(cluster) %>%
mutate(total= g1_cov + g2_cov + g3_cov + g4_cov)
write.csv(x = piecharts, "covdat.csv")
piecharts
piecharts %>%
arrange(cluster) %>%
mutate(total= g1_cov + g2_cov + g3_cov + g4_cov)
piecharts = bind_cols(data.frame(cluster = k.cluster$clustering), ord.mat)
piecharts$cluster[piecharts$cluster == 1] = "Natives"
piecharts$cluster[piecharts$cluster == 2] = "Wet Annuals"
piecharts$cluster[piecharts$cluster == 3] = "WAPS"
piecharts$cluster[piecharts$cluster == 4] = "Dry Annuals"
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_bar(stat = "identity", position = position_fill(), color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
coord_polar(theta = "y") +
facet_wrap(~cluster) +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),  axis.ticks = element_blank(),
panel.grid  = element_blank(), axis.text = element_blank(), legend.title = element_blank()) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_bar(stat = "identity", position = position_fill(), color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),  axis.ticks = element_blank(),
panel.grid  = element_blank(), axis.text = element_blank(), legend.title = element_blank()) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_bar(position = position_fill(), color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),  axis.ticks = element_blank(),
panel.grid  = element_blank(), axis.text = element_blank(), legend.title = element_blank()) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_boxplot(position = position_fill(), color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),  axis.ticks = element_blank(),
panel.grid  = element_blank(), axis.text = element_blank(), legend.title = element_blank()) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_boxplot(color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_bar(stat = "identity", position = position_fill(), color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = "", y = cover, fill = species))+
geom_bar(stat = "identity", color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = species, y = cover, fill = species))+
geom_bar(stat = "identity", color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"))
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(cover = mean(cover)) %>%
ggplot(aes(x = species, y = cover, fill = species))+
geom_bar(stat = "identity", color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold")) +
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = mean(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold")) +
ylab("Mean Cover")
?geom_errorbar
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = mean(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
geom_bar(stat = "identity", color = "black") +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold")) +
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold")) +
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ylab("Mean Cover")
piecharts = bind_cols(data.frame(cluster = k.cluster$clustering), ord.mat)
piecharts$cluster[piecharts$cluster == 1] = "Native Perennials"
piecharts$cluster[piecharts$cluster == 2] = "Transient Annuals"
piecharts$cluster[piecharts$cluster == 3] = "Invasive Annuals"
piecharts$cluster[piecharts$cluster == 4] = "Resilient Annuals"
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Relative Mean Cover of Vegetation States")
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Mean Species Cover of Vegetation Groups")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Mean Species Cover of Vegetation Groups") +
ylab("Mean Cover")
piecharts
piecharts[,-1] %>%
apply(MARGIN = 1, function(x){x / sum(x)})
piecharts[,-1]
piecharts[,-1] %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)}) %>%
bind_cols(piecharts$cluster)
piecharts[,-1] %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)}) %>%
data.frame() %>%
bind_cols(piecharts$cluster)
piecharts[,-1] %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)}) %>%
as.data.frame()
piecharts[,-1] %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)})
piecharts[,-1]
piecharts[,-1] %>%
as.matrix()
piecharts[,-1] %>%
as.matrix()
apply(MARGIN = 1, FUN = function(x){x / sum(x)})
piecharts[,-1] %>%
as.matrix() %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)})
piecharts[,-1] %>%
as.matrix() %>%
apply(MARGIN = 1, FUN = function(x){x / sum(x)}) %>%
as.data.frame()
?apply()
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Mean Relative Species Cover of Vegetation Groups") +
ylab("Mean Cover")
decostand(ord.mat, method = "total")
piecharts = bind_cols(data.frame(cluster = k.cluster$clustering), decostand(ord.mat, method = "total"))
piecharts$cluster[piecharts$cluster == 1] = "Native Perennials"
piecharts$cluster[piecharts$cluster == 2] = "Transient Annuals"
piecharts$cluster[piecharts$cluster == 3] = "Invasive Annuals"
piecharts$cluster[piecharts$cluster == 4] = "Resilient Annuals"
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover)) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Mean Relative Species Cover of Vegetation Groups") +
ylab("Mean Cover")
piecharts %>%
gather(key = "species", value = "cover", -cluster) %>%
group_by(cluster, species) %>%
summarise(meancover = mean(cover),
se_cover = sd(cover) / sqrt(dplyr::n())) %>%
ggplot(aes(x = species, y = meancover, fill = species))+
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = meancover - se_cover, ymax = meancover + se_cover), width = .5) +
# geom_text(aes(label = Cnt), position = position_fill(vjust = 0.5)) +
facet_wrap(~cluster) +
theme(legend.position='bottom') + guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
theme(strip.text.x = element_text(size = 20, face = "bold"),
axis.text.x = element_text(angle = 90)) +
guides(fill = FALSE) +
ggtitle("Mean Relative Species Cover of Vegetation Groups") +
ylab("Mean Relative Cover")
